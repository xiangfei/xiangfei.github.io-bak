<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="hive 3.1.2 高可用安装, openstack,opennebula">
    <meta name="description" content="机器


vip
ip
host
OS




192.168.151.200
192.168.226.64
hadoop-cluster-1
centos 7


192.168.151.200
192.168.226.65
hadoop">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>hive 3.1.2 高可用安装 | 1320959247@qq.com</title>
    <link rel="icon" type="image/png" href="/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/mermaid/mermaid.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">

    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"></head>


<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">1320959247@qq.com</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>首页</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>标签</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>分类</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>归档</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>关于</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle"></i>
            
            <span>朋友</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/studies" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>学习资料</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="搜索"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">1320959247@qq.com</div>
        <div class="logo-desc">
            
            geek
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                首页
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                标签
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                分类
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                归档
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                关于
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle"></i>
                
                朋友
            </a>
        </li>
        
        <li>
            <a href="/studies" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                学习资料
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/xiangfei/" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/xiangfei/" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>





<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/7.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        hive 3.1.2 高可用安装
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        margin: 35px 0 15px 0;
        padding-left: 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #toc-content .is-active-link::before {
        background-color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 20px;
        bottom: 76px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/bigdata/" target="_blank">
                                <span class="chip bg-color">bigdata</span>
                            </a>
                        
                            <a href="/tags/hive/" target="_blank">
                                <span class="chip bg-color">hive</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                            <a href="/categories/hive/" class="post-category" target="_blank">
                                hive
                            </a>
                        
                            <a href="/categories/hive/bigdata/" class="post-category" target="_blank">
                                bigdata
                            </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2020-08-19
                </div>

                
                    
                    <div class="info-break-policy">
                        <i class="fa fa-file-word-o fa-fw"></i>文章字数:&nbsp;&nbsp;
                        3.7k
                    </div>
                    

                    
                    <div class="info-break-policy">
                        <i class="fa fa-clock-o fa-fw"></i>阅读时长:&nbsp;&nbsp;
                        22 分
                    </div>
                    
                
				
				
                    <div id="busuanzi_container_page_pv" class="info-break-policy">
                        <i class="fa fa-eye fa-fw"></i>阅读次数:&nbsp;&nbsp;
                        <span id="busuanzi_value_page_pv"></span>
                    </div>
				
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h4 id="机器"><a href="#机器" class="headerlink" title="机器"></a>机器</h4><table>
<thead>
<tr>
<th>vip</th>
<th>ip</th>
<th>host</th>
<th>OS</th>
</tr>
</thead>
<tbody>
<tr>
<td>192.168.151.200</td>
<td>192.168.226.64</td>
<td>hadoop-cluster-1</td>
<td>centos 7</td>
</tr>
<tr>
<td>192.168.151.200</td>
<td>192.168.226.65</td>
<td>hadoop-cluster-2</td>
<td>centos 7</td>
</tr>
<tr>
<td>192.168.151.200</td>
<td>192.168.226.63</td>
<td>hadoop-cluster-3</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.226.66</td>
<td>hadoop-datanode01</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.226.67</td>
<td>hadoop-datanode02</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.226.68</td>
<td>hadoop-datanode03</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.226.69</td>
<td>hadoop-datanode04</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.213.59</td>
<td>mariadb-galera-cluster</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.213.65</td>
<td>mariadb-galera-cluster</td>
<td>centos 7</td>
</tr>
<tr>
<td></td>
<td>192.168.213.58</td>
<td>mariadb-galera-cluster</td>
<td>centos 7</td>
</tr>
</tbody>
</table>
<h4 id="cluster-node"><a href="#cluster-node" class="headerlink" title="cluster node"></a>cluster node</h4><ul>
<li>hiveserver2</li>
</ul>
<h3 id="tar包下载"><a href="#tar包下载" class="headerlink" title="tar包下载"></a>tar包下载</h3><ul>
<li><a href="https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz" target="_blank" rel="noopener">https://mirrors.tuna.tsinghua.edu.cn/apache/hive/hive-3.1.2/apache-hive-3.1.2-bin.tar.gz</a></li>
</ul>
<h3 id="cluster-配置"><a href="#cluster-配置" class="headerlink" title="cluster 配置"></a>cluster 配置</h3><h4 id="add-hive-home-path"><a href="#add-hive-home-path" class="headerlink" title="add hive_home_path"></a>add hive_home_path</h4><pre><code># /etc/profile
export HIVE_HOME=/data/tools/apache-hive-3.1.2-bin
export PATH=$HIVE_HOME/bin:$PATH

</code></pre><h4 id="创建hive-dir"><a href="#创建hive-dir" class="headerlink" title="创建hive dir"></a>创建hive dir</h4><pre><code>[root@hadoop-cluster-2 bin]# ./hadoop  fs -mkdir       /tmp
2020-08-19 07:00:55,671 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[root@hadoop-cluster-2 bin]# 
[root@hadoop-cluster-2 bin]# ./hadoop  fs -mkdir          /user/hive/warehouse
2020-08-19 07:01:12,608 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
mkdir: `hdfs://mycluster/user/hive&#39;: No such file or directory
[root@hadoop-cluster-2 bin]# ./hadoop  fs -mkdir       -p   /user/hive/warehouse
2020-08-19 07:01:35,783 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[root@hadoop-cluster-2 bin]# ./hadoop  fs  -chmod g+w   /tmp
2020-08-19 07:02:04,907 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[root@hadoop-cluster-2 bin]# ./hadoop  fs -chmod g+w   /user/hive/warehouse
2020-08-19 07:02:20,989 WARN util.NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
[root@hadoop-cluster-2 bin]# 

</code></pre><h4 id="安装-mariadb-clint"><a href="#安装-mariadb-clint" class="headerlink" title="安装 mariadb clint"></a>安装 mariadb clint</h4><pre><code>[root@hadoop-cluster-2 conf]# yum -y install mariadb mariadb-dev mariadb-server
</code></pre><h4 id="修改hive-remote-配置"><a href="#修改hive-remote-配置" class="headerlink" title="修改hive remote 配置"></a>修改hive remote 配置</h4><ul>
<li>touch apache-hive-3.1.2-bin/conf/hive-site.xml </li>
</ul>
<pre><code>[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# cat conf/hive-site.xml 
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;
&lt;configuration&gt;
        &lt;property&gt;
                &lt;name&gt;javax.jdo.option.ConnectionURL&lt;/name&gt;
                &lt;value&gt;jdbc:mysql://192.168.213.59:3306/hive&lt;/value&gt;
        &lt;/property&gt;

        &lt;property&gt;
                &lt;name&gt;javax.jdo.option.ConnectionDriverName&lt;/name&gt;
                &lt;value&gt;com.mysql.jdbc.Driver&lt;/value&gt;
        &lt;/property&gt;

        &lt;property&gt;
                &lt;name&gt;javax.jdo.option.ConnectionUserName&lt;/name&gt;
                &lt;value&gt;root&lt;/value&gt;
        &lt;/property&gt;

        &lt;property&gt;
                &lt;name&gt;javax.jdo.option.ConnectionPassword&lt;/name&gt;
                &lt;value&gt;123456&lt;/value&gt;
        &lt;/property&gt;

        &lt;property&gt;
                &lt;name&gt;hive.metastore.schema.verification&lt;/name&gt;
                &lt;value&gt;false&lt;/value&gt;
        &lt;/property&gt;
    &lt;property&gt; 
            &lt;name&gt;hive.cli.print.current.db&lt;/name&gt;
         &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt; 
             &lt;name&gt;hive.cli.print.header&lt;/name&gt;
             &lt;value&gt;true&lt;/value&gt;
    &lt;/property&gt;
    &lt;property&gt;
                &lt;name&gt;hive.server2.thrift.port&lt;/name&gt;
              &lt;value&gt;10000&lt;/value&gt;
    &lt;/property&gt;

        &lt;property&gt;
               &lt;name&gt;hive.server2.thrift.bind.host&lt;/name&gt;
               &lt;value&gt;192.168.213.178&lt;/value&gt;
         &lt;/property&gt;

&lt;/configuration&gt;


</code></pre><ul>
<li>hive-env.sh</li>
</ul>
<pre><code># export HIVE_CONF_DIR=

# Folder containing extra libraries required for hive compilation/execution can be controlled by:
# export HIVE_AUX_JARS_PATH=
export HIVE_HOME=/data/tools/apache-hive-3.1.2-bin
export HIVE_CONF_DIR=/data/tools/apache-hive-3.1.2-bin/conf
export HADOOP_HOME=/data/tools/hadoop-3.3.0
export HIVE_AUX_JARS_PATH=/data/tools/apache-hive-3.1.2-bin/lib
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# 

</code></pre><h3 id="初始化数据"><a href="#初始化数据" class="headerlink" title="初始化数据"></a>初始化数据</h3><pre><code>[root@hadoop-cluster-1 apache-hive-3.1.2-bin]# ./schematool -dbType mysql -initSchema

</code></pre><h3 id="启动hiveserver2"><a href="#启动hiveserver2" class="headerlink" title="启动hiveserver2"></a>启动hiveserver2</h3><pre><code>[root@hadoop-cluster-2 bin]# cat start.sh 
nohup ./hiveserver2 2&gt;&amp;1 &gt;/dev/null&amp;
[root@hadoop-cluster-2 bin]# 

</code></pre><h3 id="error"><a href="#error" class="headerlink" title="error"></a>error</h3><ul>
<li>java.lang.NoSuchMethodError: com.google.common.base.Preconditions.checkArgument</li>
</ul>
<pre><code>which: no hbase in (/data/tools/apache-hive-3.1.2-bin/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin)
2020-08-19 15:54:32: Starting HiveServer2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/data/tools/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/data/tools/hadoop-3.3.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Exception in thread &quot;main&quot; java.lang.NoSuchMethodError: com.google.common.base.Preconditions.checkArgument(ZLjava/lang/String;Ljava/lang/Object;)V
    at org.apache.hadoop.conf.Configuration.set(Configuration.java:1380)
    at org.apache.hadoop.conf.Configuration.set(Configuration.java:1361)
    at org.apache.hadoop.mapred.JobConf.setJar(JobConf.java:536)
    at org.apache.hadoop.mapred.JobConf.setJarByClass(JobConf.java:554)
    at org.apache.hadoop.mapred.JobConf.&lt;init&gt;(JobConf.java:448)
    at org.apache.hadoop.hive.conf.HiveConf.initialize(HiveConf.java:5141)
    at org.apache.hadoop.hive.conf.HiveConf.&lt;init&gt;(HiveConf.java:5099)
    at org.apache.hadoop.hive.common.LogUtils.initHiveLog4jCommon(LogUtils.java:97)


</code></pre><blockquote>
<p>hadoop和hive中guava jar包可能版本冲突，删除低版本使用高版本的jar包</p>
</blockquote>
<pre><code>[root@hadoop-cluster-2 hadoop-3.3.0]# pwd
/data/tools/hadoop-3.3.0
[root@hadoop-cluster-2 hadoop-3.3.0]# cd ../hbase-2.3.0
[root@hadoop-cluster-2 hbase-2.3.0]# find -name \*.jar | grep gu
./lib/jersey-guava-2.25.1.jar
./lib/guice-3.0.jar
./lib/guice-servlet-3.0.jar
./lib/guava-11.0.2.jar
./lib/commons-configuration-1.6.jar
[root@hadoop-cluster-2 hbase-2.3.0]# pwd
/data/tools/hbase-2.3.0
[root@hadoop-cluster-2 hbase-2.3.0]# pwd
/data/tools/hbase-2.3.0
[root@hadoop-cluster-2 hbase-2.3.0]# cd /data/tools/hadoop-3.3.0/
[root@hadoop-cluster-2 hadoop-3.3.0]# find -name \*.jar | grep gua
./share/hadoop/common/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar
./share/hadoop/common/lib/guava-27.0-jre.jar
./share/hadoop/yarn/csi/lib/guava-20.0.jar
./share/hadoop/hdfs/lib/listenablefuture-9999.0-empty-to-avoid-conflict-with-guava.jar
./share/hadoop/hdfs/lib/guava-27.0-jre.jar
[root@hadoop-cluster-2 hadoop-3.3.0]# 
[root@hadoop-cluster-2 hadoop-3.3.0]# pwd
/data/tools/hadoop-3.3.0
[root@hadoop-cluster-2 hadoop-3.3.0]# cd /data/tools/apache-
apache-hive-3.1.2-bin/        apache-hive-3.1.2-bin.tar.gz  apache-zookeeper-3.6.0-bin/   
[root@hadoop-cluster-2 hadoop-3.3.0]# cd /data/tools/apache-hive-3.1.2-bin
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# mv lib/guava-19.0.jar  lib/guava-19.0.jar.bak
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# cp /data/tools/hadoop-3.3.0/share/hadoop/yarn/csi/lib/guava-20.0.jar lib/
\[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# 
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# 
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# ./hiveserver2 
-bash: ./hiveserver2: No such file or directory
[root@hadoop-cluster-2 apache-hive-3.1.2-bin]# cd bin
[root@hadoop-cluster-2 bin]# ./hiveserver2 
which: no hbase in (/data/tools/apache-hive-3.1.2-bin/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/root/bin)
2020-08-19 16:01:32: Starting HiveServer2
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/data/tools/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/data/tools/hadoop-3.3.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Hive Session ID = edac1d17-208b-4a6e-b79e-af51f84a2d29

</code></pre><ul>
<li>初始化提示mysql jar包 找不到</li>
</ul>
<pre><code>[root@hadoop-cluster-1 bin]# ./schematool -dbType mysql -initSchema
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/data/tools/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/data/tools/hadoop-3.3.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Metastore connection URL:     jdbc:mysql://192.168.213.59:3306/hive
Metastore Connection Driver :     com.mysql.jdbc.Driver
Metastore connection User:     root
org.apache.hadoop.hive.metastore.HiveMetaException: Failed to load driver
Underlying cause: java.lang.ClassNotFoundException : com.mysql.jdbc.Driver
Use --verbose for detailed stacktrace.
*** schemaTool failed ***

</code></pre><blockquote>
<p>下载 java connector(mysql-connector-java-8.0.21.jar) 放到lib 目录 ,maven repo 下载</p>
</blockquote>
<ul>
<li>连接hive 报错</li>
</ul>
<pre><code>Beeline version 3.1.2 by Apache Hive
beeline&gt; 
beeline&gt; 
beeline&gt; !connect jdbc:hive2://192.168.226.64:10000
Connecting to jdbc:hive2://192.168.226.64:10000
Enter username for jdbc:hive2://192.168.226.64:10000: root
Enter password for jdbc:hive2://192.168.226.64:10000: ******
20/08/20 06:43:44 [main]: WARN jdbc.HiveConnection: Failed to connect to 192.168.226.64:10000
Error: Could not open client transport with JDBC Uri: jdbc:hive2://192.168.226.64:10000: Failed to open new session: java.lang.RuntimeException: org.apache.hadoop.ipc.RemoteException(org.apache.hadoop.security.authorize.AuthorizationException): User: root is not allowed to impersonate root (state=08S01,code=0)
beeline&gt; exit

</code></pre><p> 修改 hadoop core-site.xml 文件(需要重启)  改动没效果 </p>
<pre><code>[root@hadoop-cluster-1 hadoop-3.3.0]# cat  etc/hadoop/core-site.xml 
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;
&lt;!--
  Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an &quot;AS IS&quot; BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License. See accompanying LICENSE file.
--&gt;

&lt;!-- Put site-specific property overrides in this file. --&gt;

&lt;configuration&gt;
    &lt;property&gt;
        &lt;name&gt;fs.defaultFS&lt;/name&gt;
        &lt;value&gt;hdfs://mycluster&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;hadoop.tmp.dir&lt;/name&gt;
        &lt;value&gt;/data/tools/hadoop-3.3.0/tmp&lt;/value&gt;
    &lt;/property&gt;

    &lt;property&gt;
        &lt;name&gt;ha.zookeeper.quorum&lt;/name&gt;
        &lt;value&gt;hadoop-cluster-1:2181,hadoop-cluster-2:2181,hadoop-cluster-3:2181&lt;/value&gt;
    &lt;/property&gt;
     &lt;property&gt;
         &lt;name&gt;hadoop.proxyuser.root.hosts&lt;/name&gt;
         &lt;value&gt;*&lt;/value&gt;
     &lt;/property&gt;

    &lt;property&gt;
         &lt;name&gt;hadoop.proxyuser.root.groups&lt;/name&gt;
         &lt;value&gt;*&lt;/value&gt;
    &lt;/property&gt;
&lt;/configuration&gt;

</code></pre><p>修改 hive-site.xml 文件</p>
<pre><code>[root@hadoop-cluster-1 bin]# cat  ../conf/hive-site.xml 
&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;no&quot;?&gt;&lt;?xml-stylesheet type=&quot;text/xsl&quot; href=&quot;configuration.xsl&quot;?&gt;
&lt;configuration&gt;
 &lt;property&gt;
  &lt;name&gt;hive.server2.enable.doAs&lt;/name&gt;
  &lt;value&gt;false&lt;/value&gt; 
  &lt;/property&gt;
&lt;/configuration&gt;

</code></pre><ul>
<li>too many connections</li>
</ul>
<pre><code>Unexpected end of file when reading from HS2 server. The root cause might be too many concurrent connections. Please ask the administrator to check the number of active connections, and adjust hive.server2.thrift.max.worker.threads if applicable
</code></pre><blockquote>
<p>如果启动Hbase thrift server2 需要关闭</p>
</blockquote>
<ul>
<li>找不到 org.apache.tez.dag.api.SessionNotRunning</li>
</ul>
<pre><code>2020-08-20T07:34:23,932  INFO [main] server.HiveServer2: Stopped tez session pool manager.
2020-08-20T07:34:23,932  WARN [main] server.HiveServer2: Error starting HiveServer2 on attempt 1, will retry in 60000ms
java.lang.NoClassDefFoundError: org/apache/tez/dag/api/SessionNotRunning
    at org.apache.hadoop.hive.ql.exec.tez.TezSessionPoolSession$AbstractTriggerValidator.startTriggerValidator(TezSessionPoolSession.java:74) ~[hive-exec-3.1.2.jar:3.1.2]
    at org.apache.hadoop.hive.ql.exec.tez.TezSessionPoolManager.initTriggers(TezSessionPoolManager.java:207) ~[hive-exec-3.1.2.jar:3.1.2]
    at org.apache.hadoop.hive.ql.exec.tez.TezSessionPoolManager.startPool(TezSessionPoolManager.java:114) ~[hive-exec-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.initAndStartTezSessionPoolManager(HiveServer2.java:839) ~[hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.startOrReconnectTezSessions(HiveServer2.java:822) ~[hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.start(HiveServer2.java:745) ~[hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.startHiveServer2(HiveServer2.java:1037) [hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.access$1600(HiveServer2.java:140) [hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2$StartOptionExecutor.execute(HiveServer2.java:1305) [hive-service-3.1.2.jar:3.1.2]
    at org.apache.hive.service.server.HiveServer2.main(HiveServer2.java:1149) [hive-service-3.1.2.jar:3.1.2]
    at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~[?:1.8.0_262]
    at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~[?:1.8.0_262]
    at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~[?:1.8.0_262]
    at java.lang.reflect.Method.invoke(Method.java:498) ~[?:1.8.0_262]
    at org.apache.hadoop.util.RunJar.run(RunJar.java:323) [hadoop-common-3.3.0.jar:?]
    at org.apache.hadoop.util.RunJar.main(RunJar.java:236) [hadoop-common-3.3.0.jar:?]
Caused by: java.lang.ClassNotFoundException: org.apache.tez.dag.api.SessionNotRunning

</code></pre><blockquote>
<p>需要安装apache-tez ,或者禁用 HS2交互式HA配置</p>
</blockquote>
<pre><code>&lt;property&gt;
    &lt;name&gt;hive.server2.active.passive.ha.enable&lt;/name&gt;
    &lt;value&gt;true&lt;/value&gt; # change false to true
&lt;/property&gt;

</code></pre><ul>
<li>mapred 失败<ul>
<li>替换tez 或者spark</li>
</ul>
</li>
</ul>
<pre><code>INFO  : Executing command(queryId=root_20200824075830_35100282-b95f-4c20-bb7d-c90cb11dec8c): select * from hbase_machine_resource_usage  order  by  cpuusage   limit 1
WARN  : Hive-on-MR is deprecated in Hive 2 and may not be available in the future versions. Consider using a different execution engine (i.e. spark, tez) or using Hive 1.X releases.
....
Error: Error while processing statement: FAILED: Execution Error, return code 2 from org.apache.hadoop.hive.ql.exec.mr.MapRedTask (state=08S01,code=2)
0: jdbc:hive2://192.168.212.213:9090&gt; select * from hbase_machine_resource_usage  order  by  cpuusage  desc  limit 1;

</code></pre><h3 id="说明"><a href="#说明" class="headerlink" title="说明"></a>说明</h3><blockquote>
<p>配置galera cluster ,其他2 台机器连接自己的thrift2 server 和数据库配置</p>
</blockquote>
<pre><code>2020-08-20T07:50:28,229  INFO [main] service.AbstractService: Service:HiveServer2 is started.
2020-08-20T07:50:28,230  WARN [main] server.HiveServer2: No policy provider found, skip creating PrivilegeSynchonizer
2020-08-20T07:50:28,232  INFO [main] server.Server: jetty-9.3.20.v20170531
2020-08-20T07:50:28,411  INFO [main] handler.ContextHandler: Started o.e.j.w.WebAppContext@30036a18{/,file:///tmp/jetty-0.0.0.0-10002-hiveserver2-_-any-7344828647128270757.dir/webapp/,AVAILABLE}{jar:file:/data/tools/apache-hive-3.1.2-bin/lib/hive-service-3.1.2.jar!/hive-webapps/hiveserver2}
2020-08-20T07:50:28,413  INFO [main] handler.ContextHandler: Started o.e.j.s.ServletContextHandler@537b3b2e{/static,jar:file:/data/tools/apache-hive-3.1.2-bin/lib/hive-service-3.1.2.jar!/hive-webapps/static,AVAILABLE}
2020-08-20T07:50:28,415  INFO [main] handler.ContextHandler: Started o.e.j.s.ServletContextHandler@1544ded3{/logs,file:///tmp/root/,AVAILABLE}
2020-08-20T07:50:28,427  INFO [main] server.AbstractConnector: Started ServerConnector@305b43ca{HTTP/1.1,[http/1.1]}{0.0.0.0:10002}
2020-08-20T07:50:28,427  INFO [main] server.HiveServer2: Web UI has started on port 10002
2020-08-20T07:50:28,427  INFO [main] server.HiveServer2: HS2 interactive HA enabled. Tez sessions will be started/reconnected by the leader.
2020-08-20T07:50:28,427  INFO [main] server.Server: Started @14561ms
2020-08-20T07:50:28,427  INFO [main] http.HttpServer: Started HttpServer[hiveserver2] on port 10002


</code></pre><ul>
<li>连接数据</li>
</ul>
<pre><code>[root@hadoop-cluster-1 bin]# ./beeline 
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/data/tools/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/data/tools/hadoop-3.3.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/data/tools/apache-hive-3.1.2-bin/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/data/tools/hadoop-3.3.0/share/hadoop/common/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]
Beeline version 3.1.2 by Apache Hive
beeline&gt; !connect jdbc:hive2://192.168.212.157:9090
Connecting to jdbc:hive2://192.168.212.157:9090
Enter username for jdbc:hive2://192.168.212.157:9090: root
Enter password for jdbc:hive2://192.168.212.157:9090: ******
Connected to: Apache Hive (version 3.1.2)
Driver: Hive JDBC (version 3.1.2)
Transaction isolation: TRANSACTION_REPEATABLE_READ
0: jdbc:hive2://192.168.212.157:9090&gt; 
0: jdbc:hive2://192.168.212.157:9090&gt; show databases;
INFO  : Compiling command(queryId=root_20200820075115_b23ea40f-c23c-4eb4-b116-c9726837f61f): show databases
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:database_name, type:string, comment:from deserializer)], properties:null)
INFO  : Completed compiling command(queryId=root_20200820075115_b23ea40f-c23c-4eb4-b116-c9726837f61f); Time taken: 1.406 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=root_20200820075115_b23ea40f-c23c-4eb4-b116-c9726837f61f): show databases
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=root_20200820075115_b23ea40f-c23c-4eb4-b116-c9726837f61f); Time taken: 0.104 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+----------------+
| database_name  |
+----------------+
| default        |
+----------------+
1 row selected (2.168 seconds)
0: jdbc:hive2://192.168.212.157:9090&gt; exit



0: jdbc:hive2://hadoop-cluster-2:9090&gt; create external table hbase_machine_resource_usage(id string, ip string, cpuusage float , memoryusage float) STORED BY &#39;org.apache.hadoop.hive.hbase.HBaseStorageHandler&#39; WITH SERDEPROPERTIES (&quot;hbase.columns.mapping&quot; = &quot;:key,base:ip,base:cpuusage,base:memoryusage&quot;) TBLPROPERTIES(&quot;hbase.table.name&quot; = &quot;hbase_machine_resource_usage&quot;) ;
INFO  : Compiling command(queryId=root_20200824074725_74ad8cf7-0532-4a9c-a945-9b3f85c4667b): create external table hbase_machine_resource_usage(id string, ip string, cpuusage float , memoryusage float) STORED BY &#39;org.apache.hadoop.hive.hbase.HBaseStorageHandler&#39; WITH SERDEPROPERTIES (&quot;hbase.columns.mapping&quot; = &quot;:key,base:ip,base:cpuusage,base:memoryusage&quot;) TBLPROPERTIES(&quot;hbase.table.name&quot; = &quot;hbase_machine_resource_usage&quot;)
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=root_20200824074725_74ad8cf7-0532-4a9c-a945-9b3f85c4667b); Time taken: 0.275 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=root_20200824074725_74ad8cf7-0532-4a9c-a945-9b3f85c4667b): create external table hbase_machine_resource_usage(id string, ip string, cpuusage float , memoryusage float) STORED BY &#39;org.apache.hadoop.hive.hbase.HBaseStorageHandler&#39; WITH SERDEPROPERTIES (&quot;hbase.columns.mapping&quot; = &quot;:key,base:ip,base:cpuusage,base:memoryusage&quot;) TBLPROPERTIES(&quot;hbase.table.name&quot; = &quot;hbase_machine_resource_usage&quot;)
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=root_20200824074725_74ad8cf7-0532-4a9c-a945-9b3f85c4667b); Time taken: 4.29 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
No rows affected (4.588 seconds)
0: jdbc:hive2://hadoop-cluster-2:10000&gt; 



</code></pre><link rel="stylesheet" href="/css/spoiler.css" type="text/css"><script src="/js/spoiler.js" type="text/javascript" async></script>
            </div>
            <hr/>

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">赏</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">你的赏识是我前进的动力</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">支付宝</a></li>
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">微 信</a></li>
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="支付宝打赏二维码">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="微信打赏二维码">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>微信里点“发现”->“扫一扫”二维码便可查看分享。</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            <div class="reprint">
                <p>
                    <span class="reprint-tip">
                        <i class="fa fa-exclamation-circle"></i>&nbsp;&nbsp;转载请注明:
                    </span>
                    <a href="http://yoursite.com" class="b-link-green">1320959247@qq.com</a>
                    <i class="fa fa-angle-right fa-lg fa-fw text-color"></i>
                    <a href="/2020/08/19/hive/" class="b-link-green">hive 3.1.2 高可用安装</a>
                </p>
            </div>
        </div>
    </div>

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2020/08/24/tez/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/9.jpg" class="responsive-img" alt="hive tez 集成">
                        
                        <span class="card-title">hive tez 集成</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">下载 bin 包
url http://archive.apache.org/dist/tez/0.9.2/
gitlab 下载 0.9.2 source 包编译,会报错

zip 包放到hadoop filesystem[root@had</div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2020-08-24
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/hive/" class="post-category" target="_blank">
                                    hive
                                </a>
                            
                            <a href="/categories/hive/tez/" class="post-category" target="_blank">
                                    tez
                                </a>
                            
                            <a href="/categories/hive/tez/bigdata/" class="post-category" target="_blank">
                                    bigdata
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/bigdata/" target="_blank">
                        <span class="chip bg-color">bigdata</span>
                    </a>
                    
                    <a href="/tags/hive/" target="_blank">
                        <span class="chip bg-color">hive</span>
                    </a>
                    
                    <a href="/tags/tez/" target="_blank">
                        <span class="chip bg-color">tez</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6 overflow-policy" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2020/08/14/opentsdb/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/17.jpg" class="responsive-img" alt="opentsdb 2.4.0 集群安装">
                        
                        <span class="card-title">opentsdb 2.4.0 集群安装</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">准备机器


vip
ip
host
OS




192.168.151.200
192.168.226.64
hadoop-cluster-1
centos 7


192.168.151.200
192.168.226.65
hado</div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2020-08-14
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/opentsdb/" class="post-category" target="_blank">
                                    opentsdb
                                </a>
                            
                            <a href="/categories/opentsdb/bigdata/" class="post-category" target="_blank">
                                    bigdata
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/bigdata/" target="_blank">
                        <span class="chip bg-color">bigdata</span>
                    </a>
                    
                    <a href="/tags/opentsdb/" target="_blank">
                        <span class="chip bg-color">opentsdb</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + '来源: 1320959247@qq.com<br />'
            + '作者: 相飞<br />'
            + '链接: <a href="' + url + '">' + url + '</a><br />'
            + '本文章著作权归作者所有，任何形式的转载都请注明出处。';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () {bodyElement.removeChild(newdiv);}, 200);
    });
</script>

    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget">
            <div class="toc-title"><i class="fa fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fa fa-list"></i>
    </a>
</div>


<script src="/libs/tocbot/tocbot.min.js"></script>
<script>
    $(function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            // headingsOffset: -205,
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).slideUp(500);
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).slideDown(500);
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    });
</script>
    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            本站由&copy;<a href="https://blinkfox.github.io/" target="_blank">Blinkfox</a>基于
            <a href="https://hexo.io/" target="_blank">Hexo</a> 的
            <a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">hexo-theme-matery</a>主题搭建.

            
                &nbsp;<i class="fa fa-area-chart"></i>&nbsp;站点总字数:&nbsp;
                <span class="white-color">91.7k</span>
            

            
			
                <br>
                
                <span id="busuanzi_container_site_pv">
                    <i class="fa fa-heart-o"></i>
                    本站总访问量 <span id="busuanzi_value_site_pv" class="white-color"></span>
                </span>
                
                
                <span id="busuanzi_container_site_uv">
                    <i class="fa fa-users"></i>
                    次,&nbsp;访客数 <span id="busuanzi_value_site_uv" class="white-color"></span> 人.
                </span>
                
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">


    <a href="mailto:1302959247@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>



    <a href="tencent://AddContact/?fromId=50&fromSubId=1&subcmd=all&uin=1320959247" class="tooltipped" data-tooltip="QQ联系我: 1320959247" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS 订阅" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/libs/mermaid/mermaid.js"></script>
<!--script>mermaid.initialize({startOnLoad:true});</script -->

  <script>
    mermaid.initialize({
      theme: 'forest',
      // themeCSS: '.node rect { fill: red; }',
      logLevel: 3,
      securityLevel: 'loose',
      flowchart: { curve: 'basis' },
      gantt: { axisFormat: '%m/%d/%Y' },
      sequence: { actorMargin: 50 },
      // sequenceDiagram: { actorMargin: 300 } // deprecated
    });
  </script>

 <script>
    function ganttTestClick(a, b, c){
      console.log("a:", a)
      console.log("b:", b)
      console.log("c:", c)
    }
    function testClick(nodeId) {
      console.log("clicked", nodeId)
      var originalBgColor = document.querySelector('body').style.backgroundColor
      document.querySelector('body').style.backgroundColor = 'yellow'
      setTimeout(function() {
        document.querySelector('body').style.backgroundColor = originalBgColor
      }, 100)
    }
  </script>
  <script>
     const testLineEndings = (test, input) => {
       try {
         mermaid.render(test, input, () => {});
       } catch (err) {
         console.error("Error in %s:\n\n%s", test, err);
       }
     };

     testLineEndings("CR", "graph LR\rsubgraph CR\rA --> B\rend");
     testLineEndings("LF", "graph LR\nsubgraph LF\nA --> B\nend");
     testLineEndings("CRLF", "graph LR\r\nsubgraph CRLF\r\nA --> B\r\nend");
  </script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->



    <script src="/libs/others/clicklove.js"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>


</body>
</html>
